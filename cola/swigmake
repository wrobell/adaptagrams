JAVA_HOME = /usr/lib/jvm/java-6-sun-1.6.0.06
PLATFORM = linux
OSXLINK = g++ -dynamiclib -framework JavaVM -o cola.jnilib
LINUXLINK = g++ -shared -o libcolajni.so
LINK = $(LINUXLINK)

all: cola.jnilib colajava.jar

cola_wrap.cxx swig-worked: cola.i
	rm -f swig-worked
	rm -rf colajava/*
	swig -c++ -java -package colajava -outdir colajava cola.i
	touch swig-worked

cola_wrap.o: cola_wrap.cxx swig-worked
	g++ `pkg-config --cflags cairomm-1.0` -I. -I$(JAVA_HOME)/include -I$(JAVA_HOME)/include/$(PLATFORM) -c cola_wrap.cxx

cola.jnilib: cola_wrap.o
	$(LINK) cola_wrap.o libcola/libcola.a libproject/libproject.a libtopology/libtopology.a libavoid/libavoid.a libvpsc/libvpsc.a

colajava.jar: colajava swig-worked
	jar -cf colajava.jar colajava

realclean: clean
clean: mostlyclean
	rm -f cola.jnilib

mostlyclean:
	rm -f cola_wrap.o cola_wrap.cxx colajava.jar
	rm -rf colajava/*

.PHONY: all clean mostlyclean realclean
